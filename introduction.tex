

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                                 %
%                       Introduction                              %
%                                                                 %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\chapter{Introduction} \label{c:introduction}
Imagine a world without encryption. Anyone with access to a computer could
steal your money, impersonate you, or learn your secrets.  Privacy would be
dead. The inability to secure information might even lead to police states,
where governments will have to resort to desparate measures to protect their
secrets.  Fortunately, we do not live in such a world. We live in a world where
encryption is a very real part of our daily lives. Whether banking online,
shopping for new items or chatting to your friends on your favourite social
network, you are indirectly using various forms of encryption to keep your
messages safe, and indicate to computer servers that you are who you say you
are.

So if our data is all secure and encrypted, why should we worry more about the
subject of Cryptography? In short, our data isn't secure. Attackers find more
and more ingenious ways of breaking implementations and protocols, even when
the encryption method is said to be secure. The premier algorithm for
encrypting electronic data from 1979 onwards, known as the Data Encryption
Standard (DES), was broken in 1997. [citation needed] Today's encryption
standards are tomorrow's broken algorithms. So we, as cryptographers, have the
responsibility to make encryption more secure; even in some cases, to improve
the manner in which these algorithms are implemented! How can we do this? By
doning a black hat and thinking like an attacker. In this paper, we will be
looking at an attack on block ciphers, specifically known as differential
cryptanalysis. But first, we should probably define some unfamiliar
terminology.

\section{Terminology}

\begin{rem}
Note, this paper assumes that you have an adequate knowledge of 3rd year
university level Mathematics, but a knowledge of Cryptography or Probability
theory is not required, as all concepts necessary for understanding this paper
will be explained.
\end{rem}

As you might already know, \textbf{Cryptography} is the discipline concerned
with keeping data secret, or more formally, it is the study and practice
of techniques and algorithms for securing the transference of data
in the presence of third parties, known as attackers or adversaries.
\textbf{Cryptanalysis} however, deals with the breaking of these techniques 
and retrieval of the secret data. 

In cryptography, \textbf{encryption} refers to the process of converting plaintext,
or data that is easily understandable, into ciphertext, that is unintelligible
data. The reverse process of converting the cipher text back into plaintext is known
as \textbf{decryption}. In most cases, this encryption or decryption occurs with 
the aid of a \textbf{key}, a parameter that determines the functional output of 
the cryptographic algorithm.

Furthermore, there are two main types which come up when discussing key-based 
cryptography, namely Symmetric-key, and Asymmetric-key or Public-key cryptography. 
In the case of \textbf{Symmetric-key}, the same key is used for encryption and 
decryption, while with \textbf{Asymmetric-key}, a key is made available 
to the public for encryption, and only those posessing the secret or private 
key will be able to decrypt messages encrypted with the matching public key.

A \textbf{block cipher} is a type of Symmetric-key encryption cipher that operates
on a fixed-length ``block'' of data. This is in contrast to a \textbf{stream cipher},
which operates on a potentially infinite stream of data. For the purposes of this
paper, we will define a block cipher in more depth later, but at the moment we 
have enough of a vocabulary to delve into a bit of supporting knowledge.

\begin{comment}
To introduce this paper, I will give a short discussion of why we
need encryption, speak about block ciphers and differential attacks
there-on. Furthermore, I will outline what will be discussed in this
paper, namely background information on Probability Theory, Block 
Ciphers and Vectorial Boolean Functions (S-boxes), Differential
Properties of S-boxes and how Probability Theory relates. This
will build up to Differential Attacks, which will discuss the
various stages of an attack, and culminate in a Toy Example in which
a simple Block Cipher is broken. Finally there will be a conclusion
in which I summarize the paper.
\end{comment}

\begin{comment}
In this chapter we establish some conventions and collect the
results from number theory about $\Z_{p^r}^*$, the multiplicative
group of integers modulo a prime power $p^r$, that we will need in
the rest of the thesis.

\section{Definitions and notation}

We denote the field of rational numbers by $\Q$, the ring of
integers by $\Z$, and the ring of integers modulo an integer $m$
by $\Z_m$.

Let $x$ be a rational number written in lowest terms, i.e., $x =
\frac{a}{b}$ where $a$ and $b$ are coprime integers. When we refer
to ``the numerator" or ``the denominator" of $x$ we will always
mean $a$ and $b$.
% i.e., the denominator of $x$ when it is written in lowest terms.
If $m$ is an integer coprime to $b$ then by $x \bmod m$ we mean $a \, b^{-1} \bmod m$.
The notation $m \divides x$ means that $a \, b^{-1} \equiv 0 \bmod m$, and $m \notdivides
x$ means that $a \, b^{-1} \nequiv 0 \bmod m$.
% Not sure if I ever used this notation for rational numbers.
If $p$ is a prime and $x$ an integer then the notation $p^r
\maxdivides x$ means that $p^r$ is the highest power of $p$
dividing $x$.
% $x$ is divisible by $p^r$ but not by $p^{r+1}$.

If $R$ is a ring then $R^*$ denotes the multiplicative group of
invertible elements of $R$, and $R^+$ the additive group of $R$.
If $K$ is a field then we denote its algebraic closure by
$\overline{K}$.

Finally, we denote the cyclic group with $n$ elements by $C_n$.
If $g$ is an element of a group $G$, then the cyclic subgroup of
$G$ generated by $g$ is $\langle g \rangle$.





\section{The group $\Z_{p^r}^*$}

Let $p^r$ be a prime power.  We need some results about
$\Z_{p^r}^*$, the multiplicative group of invertible integers
modulo $p^r$.  Most of these follow from the fact that
$\Z_{p^r}^*$ is a cyclic group if $p$ is odd, or the product of
two cyclic groups if $p = 2$. (See for example \cite[page
91]{Rose} for a proof.)
% It can be proved that this is a cyclic group if $p$ is odd, or the product of two cyclic
% groups if $p = 2$.

\begin{thm} \label{t:cyclic} % \cite{Rose}  Rose pg 91

Let $r \in \N$.  If $p$ is an odd prime then $\Z_{p^r}^*$ is a cyclic group of order
$p^{r-1} \, (p-1)$.  For $r \ge 2$, $\Z_{2^r}^*$ is the direct product of two cyclic
groups of order $2$ and $2^{r-2}$ respectively.
% $\Z_{2^r}^* \cong C_2 \times C_{2^{r-2}$.  In other words, there exist elements $h$ and
% $g$ of order $2$ and $2^{r-2}$ respectively in $\Z_{2^r}^*$ such that every element $x$
% of $\Z_{2^r}^*$ can be written uniquely as $x \equiv h^s \, g^t \bmod 2^r$ for some
% $s \in \{0,1\}$ and $t \in \{0,1, \ldots, 2^{r-2}-1 \}$.  (i.e., $\Z_{2^r}^*$ has a basis
% of two elements, a generator pair.) Specifically, $h = -1$ will work.

\end{thm}

% So $\phi(p^r) = p^{r-1}(p-1)$ holds for $p = 2$ too.
% Note $Z_{2^r}$ still has $2^{r-1}$ elements.
% Note $2^r \divides x^2 - 1$ \; \Leftrightarrow \; $2^{r-1} \divides x \pm 1.

So for $r \ge 2$, there is an element $h$ of order $2^{r-2}$ in
$\Z_{2^r}^*$ such that each $x \in \Z_{2^r}^*$ can be written
uniquely as $\pm h^s$ for some $s \in \{0,1,\ldots,2^{r-2}\}$.
%as $(-1)^t \, h^s$ for some $s \in \{0,1,\ldots,2^{r-2}\}$ and $t \in \{0,1\}$.
%$(-1,h)$ is called a generating pair.
%(So each element of $\Z_{2^r}^*$ has order dividing $\min\{2,
%2^{r-2}\}$.)
%So $\Z_{2^r}^*$ is not cyclic unless $r = 1$ or $2$.

%Note that if $r \ge 3$ then $h$ is a quadratic non-residue (because
%if $h \equiv w^2 \bmod 2^r$ then $h^{\frac{2^{r-3}} \equiv w^{2^{r-2}} \equiv 1 \bmod 2^r$,
%and $h$ can't have order $2^{r-2}$).
% So for $r \ge 3$, $x \equiv (-1)^t \, h^s \bmod 2^r$ is a QR modulo $2^r$ if and only if $t+s$ is even.
% So exactly half the elements of $\Z_{2^r}^*$ are quadratic residues.  This is also true for $r = 2$.


\bigskip

Theorem \ref{t:cyclic} has several immediate consequences:

% Obviously if $g$ is a generator of $\Z_{p^r}^*$ then it's also a generator of $\Z_{p^{\ell}}^*$
% for any $1 \le \ell \le r$.

\begin{lem}

Let $p$ be an odd prime, $r \in \N$ and $g$ a generator of $\Z_{p^r}^*$.  Then the
element $g^s$ has order
\[ \dfrac{p^{r-1} \, (p-1)} {\gcd \left(p^{r-1} \, (p-1), \, s \right)} \]
in $\Z_{p^r}^*$, and $g^s$ is a quadratic residue modulo $p^r$ if and only if $s$ is
even.

\end{lem}

% So exactly half the elements of $\Z_{p^r}^*$ are quadratic residues.
% This follows from the fact that $g$ is a quadratic non-residue (because
% if $g = w^2$ then $g^{\frac{p^{r-1} \, (p-1)}{2}}
% \equiv w^{p^{r-1} \, (p-1)} \equiv 1 \bmod p^r$,
% and $g$ cannot be a generator).

\begin{lem} \label{l:same generator}

Let $p$ be an odd prime, $r \in \N$ and $g$ a generator of $\Z_{p^r}^*$.  Then $g$ is
also a generator for $\Z_{p^k}^*$ for all $k < r$.

Let $(-1,h)$ be a generating pair for $\Z_{2^r}^*$.  Then it is
also a generating pair for
$\Z_{2^k}^*$ for all $k < r$. % $h$ has order $2^{r-2}$.

%This is really the same as saying if $h$ has order $2^{r-2}$ modulo $2^r$ then it has order $2^{k-2}$ modulo $2^k$
%for $k \le r$.

\end{lem}

%Note $-1 \in \Z_{2^r} \leftrightarrow (-1,1) \in C_2 \times C_{2^{r-2}}$, not $(1,-1)$.
%$-1$ is not a power of $g$.

% $g$ is a generator of $\Z_{2^r}^* / \{-1,1\}$?

\begin{thm} \label{t:square roots of 1}

Let $r \in \N$.  If $p$ is an odd prime, then
\[ x^2 \equiv 1 \bmod p^r \; \Leftrightarrow \; x \equiv \pm 1 \bmod p^r. \]
For $p = 2$ we have
\begin{align*}
x^2 \equiv 1 \bmod 2^r \;
    &\Leftrightarrow \;
        x \equiv \pm 1 \bmod 2^r \text{~~ or ~~} x \equiv \pm 1 + 2^{r-1} \bmod 2^r \\
    &\Leftrightarrow \; x \equiv \pm 1 \bmod 2^{r-1}.
\end{align*}

\end{thm}

% \begin{prf}

% If $p$ is odd let $g$ be a generator of $\Z_{p^r}^*$.  Then
% $g^{2s} \equiv 1 \bmod p^r$ iff $p^{r-1} \, (p-1) \divides 2s$
% iff $\frac{1}{2} p^{r-1} \, (p-1) \divides s$ iff $g^s \equiv \pm 1 \bmod p^r$.

% If $p = 2$ then $x^2 \equiv 1 \bmod p^r \not \Rightarrow x \equiv \pm 1 \bmod p^r$.
% To see this, note that
% \[ x^2 \equiv 1 \bmod 2^r \Leftrightarrow 2^r \divides x^2-1 = (x-1)(x+1), \]
% and $2$ can divide both $(x-1)$ and $(x+1)$. % which is the difference from other primes $p$.
% But $4$ cannot divide both though, so if
% \[ 2^j \divides (x-1) \text{ and } 2^{r-j} \divides (x+1) \]
% then we must have $j = 0,1, r-1$ or $r$.
% So $x \equiv \pm 1 \bmod 2^{r-1}$, i.e., $x = \pm 1 + c 2^{r-1}$ for some integer $c$.
% So modulo $2^r$, $x$ is $\pm 1 + (c \bmod 2) 2^{r-1}$.
% In other words, $x \equiv \pm 1 \bmod 2^r$ or $x \equiv \pm 1 + 2^{r-1} \bmod 2^r$.
% So $1$ has four square roots modulo $2$.

% $-1$ is a QNR modulo $4$, so $y^{2^k}+1$ divisible by $2$ but not by $4$.
% \qed \end{prf}

So $1$ has two square roots in $\Z_{p^r}^*$ if $p$ is an odd
prime, and four square roots in $\Z_{2^r}^*$ for each $r \ge 3$
(namely, $\pm 1$ and $\pm 1 + 2^{r-1}$).
% (For $r = 2$ $\pm 1 \equiv \mp 3 \bmod 4$.)
% i.e., $1$, $h$, $g^{2^{r-3}}$ and $h \, g^{2^{r-3}}$.

% For example, if $x = 7$ and $r = 4$, then the four square roots
% of $1$ modulo $2^4$ are $\pm 1$ and $\pm 1 + 2^3$, i.e., $9$ and $7$.
\end{comment}
